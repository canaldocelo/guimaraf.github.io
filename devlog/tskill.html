<!DOCTYPE html>
<html lang="br">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="../assets/img/icon.ico">

    <title>Matar processo do NW.exe</title>

    <!-- Bootstrap core CSS -->
    <link href="../assets/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../assets/css/main.css" rel="stylesheet">

    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <!-- Static navbar -->
    <div class="navbar navbar-inverse navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">FRED OLIVEIRA</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="../works/index.html">Meus Jogos</a></li>
            <li><a href="index.html">Devlog</a></li>
            <li><a href="../prototipos/index.html">Protótipos</a></li>
            <li><a href="../about.html">Sobre</a></li>
            <li><a href="../contact.html">Contato</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

	<!-- +++++ Post +++++ -->
	<div id="grey">
	    <div class="container">
			  <div class="row">
					<p><img src="../assets/img/user.png" width="50px" height="50px"> <ba>Fred Oliveira</ba></p>
					<p><bd>10 de Agosto, 2017</bd></p>
          <h2>Matar processo do NW.exe</h2>
          <center><p><img src="../assets/img/devlog/tskill.jpg" class="img-responsive" width="70%" height="70%" title="Script Executado"></p></center>
            <p>Um problema muito comum durante o desenvolvimento usanod a game engine <b>Construct2</b> e o programa <b>Nw.exe</b> como render desktop, é em alguns 
              momentos após fechar o <b>nw.exe</b> o processo continua rodando, mesmo com a janela fechada, é conhecido como processo fantasma, que aparece no 
              gerenciador de tarefas e possui uma <b>PID</b>. Com este problema em mente, resolvi buscar uma solução simplificada para que o seja fechado o processo 
              de forma mais rápida possível, aproveitei meus conhecimentos longíncuos de programação em scripts, que utilizo para outros fins no meu atual sistema operacional.

              <p><b>O que é PID?</b></br>
                <b>PID</b> significa Process identifier (identificador de processo), <b>PID</b> ou ainda process ID é um número único que é atribuído 
                pelo sistema operacional quando um processo é executado. Esse número é utilizado para se fazer referência a um processo em execução.
              </p>
            </p>
              <p>A maioria dos navegadores reconhecem arquivos <b>.bat</b> como potenciais ameaças, por este motivo eu deixo abaixo o código do arquivo. Pegue o código e 
                cole em um arquivo no formato <b>.bat</b>, que pode ser também um arquivo <b>.txt</b>, renomeie ele para <b>.bat</b>.
              </p>
              <h3>Como matar o processo do NWjs.exe.</h3>

              <pre>
@echo off 
set proceso=nw.exe

tasklist>%tmp%\tmp.txt 
find /i "%proceso%" "%tmp%\tmp.txt">%tmp%\pid.tmp

IF ERRORLEVEL==1 (
	color C 
	echo Nao foi encotrado o "%proceso%" no sistema
	timeout /t 3
)

for /f "tokens=2 skip=2" %%p in (%tmp%\pid.tmp) do ( 
	color a 
	cls 
	tskill %%p
	echo Finalizado o NW.Exe com sucesso
	timeout /t 3
	exit
)</pre>

                <input type="checkbox"  id="spoiler1" /> 
                  <label for="spoiler1" >Mostrar</label>
                    <div class="spoiler">
                      <p>
                        <b>@echo off</b>, vai retirar o caminho do sistema.</br>
                        <b>set proceso=nw.exe</b>, cria uma variável e armazena a string que contém o nome do progrma a ser fechado.</br>
                        <b>tasklist>%tmp%\tmp.txt</b>, pega o conteúdo do comando tasklist que vai mostrar todos os processos que estão rodando no 
                        sistema operacional, joga em um arquivo tmp.txt que fica na pasta temporária do sistema operacional.</br>
                        
                        <b>find /i "%proceso%" "%tmp%\tmp.txt">%tmp%\pid.tmp</b>, o comando "find" localiza uma cadeia de caracteres de um texto, 
                        no caso do código acima, ele procura a string da segunda lina "nw.exe" dentro do arquivo tmp.txt, depois grava o segundo arquivo "pid.tmp".</br>
                        
                        <b>IF ERRORLEVEL==1</b>, será verificado se existe um processo com a string que foi guardado na variável, 
                        caso não tenha retorno, a cor da fonte do script será modificada para vermelho e exibir a mensagem "Nao foi encotrado o "%proceso%" no sistema", assim 
                        terminando o processo do script. Caso encontre a referência da string, essa linha será ignorada e vai iniciar o looping pelo comando "for".</br>

                        <b>timeout /t 3</b>,será mostrado um contador regressivo iniciando em 3, terminando a contagem o scrip será fechado.</br>

                        <b>for /f "tokens=2 skip=2" %%p in (%tmp%\pid.tmp) do (</b>, será executado um looping verificando o arquivo "pid.tmp".</br>

                        <b>color a</b>, muda a cor do script para verde.</br>

                        <b>echo O proceso "%proceso%" tem o pid --^> "%%p"</b>, será exibido a mensagem com o nome "nw.exe" junto com a sua PID encontrada.</br>

                        <b>cls</b>, limpa a tela.</br>

                        <b>tskill %%p</b>, tskill é o comando para matar o processo</br>
                        
                        <b>echo Finalizado o NW.Exe com sucesso</b>, será exibido a mensagem com o nome do processo que foi finalizado, junto com a contagem regressiva.</br>
                        
                        <b>exit</b>, limpa a tela.</br>
                      </p>
                  </div>
                <p id="pSpoiler">Clique no Spoiler para exibir o código explicado</p>

          <br>
					<p><bt>TAGS: <a href="#">Construct2</a> - <a href="#">Batch File</a></bt></p>
					<hr>
					<p><a href="devlog.html">Voltar</a></p>
				</div><!-- /row -->
			 </div><!-- /container -->
      </div> 
	<!-- +++++ Footer Section +++++ -->
	
	<div id="footer">
		<div class="container">
			<div class="row">
				<div class="col-lg-4">
					<h4>Meu Forte</h4>
					<p>
						Contagem,<br/>
						Minas Gerais, <br/>
						Brasil.
					</p>
				</div><!-- /col-lg-4 -->
				
				<div class="col-lg-4">
					<h4>Meus Links</h4>
					<p>
						<a href="https://www.linkedin.com/in/guimaraf/" target="_blank">Linkedin</a><br/>
						<a href="https://twitter.com/guimaraf1" target="_blank">Twitter</a><br/>
						<a href="https://www.facebook.com/guimaraf" target="_blank" >Facebook</a>
					</p>
				</div><!-- /col-lg-4 -->
				
				<div class="col-lg-4">
					<h4>Sobre Fred Oliveira</h4>
          <p>Quanto mais café eu bebo, melhor programador eu me torno.</p>
          
          <h4>Contato</h4>
					<a href="mailto:guimaraf@gmail.com" >guimaraf@gmail.com</a>
				</div><!-- /col-lg-4 -->
			
			</div>
		</div>
	</div>
	
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../assets/js/bootstrap.min.js"></script>
  </body>
</html>